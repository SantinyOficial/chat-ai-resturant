import{d as D,g as w}from"./chunk-65AAFHJD.js";import{a as s,b as L}from"./chunk-CHDIVYYH.js";import{Hb as S,Ib as y,Jb as k,Ka as x,Ma as l,Mb as T,Nb as N,Oa as m,Ob as A,Ra as n,Sa as t,Ta as _,Xa as P,Ya as g,Z as b,bb as i,cb as h,db as f,eb as E,jb as M,kb as u,lb as C,mb as I,va as d,wa as O}from"./chunk-DHL7B2SE.js";function F(o,c){if(o&1&&(n(0,"div",9)(1,"small"),i(2),u(3,"date"),t()()),o&2){let e=g();d(2),f("\xDAltima actualizaci\xF3n: ",C(3,1,e.lastUpdate,"dd/MM/yyyy HH:mm:ss"),"")}}function R(o,c){o&1&&(n(0,"div",10)(1,"p"),i(2,"No tienes pedidos realizados. Puedes hacer tu pedido hablando con nuestro asistente."),t(),n(3,"button",11),i(4,"Ir al Asistente"),t()())}function z(o,c){o&1&&(n(0,"div",12),_(1,"div",13),n(2,"p"),i(3,"Cargando pedidos..."),t()())}function U(o,c){if(o&1&&(n(0,"li"),i(1),t()),o&2){let e=c.$implicit;d(),E(" ",e.cantidad," x ",e.nombre," ")}}function B(o,c){if(o&1&&(n(0,"p")(1,"strong"),i(2,"Observaciones:"),t(),i(3),t()),o&2){let e=g().$implicit;d(3),f(" ",e.observaciones,"")}}function G(o,c){if(o&1&&(n(0,"div",27)(1,"div",28)(2,"div",29),_(3,"div",30),n(4,"span",31),i(5,"Recibido"),t()(),n(6,"div",29),_(7,"div",30),n(8,"span",31),i(9,"En preparaci\xF3n"),t()(),n(10,"div",29),_(11,"div",30),n(12,"span",31),i(13,"Listo"),t()(),n(14,"div",29),_(15,"div",30),n(16,"span",31),i(17,"Entregado"),t()()()()),o&2){let e=g().$implicit,r=g(2);d(2),m("completed",r.isStepCompleted(e.estado,"PENDIENTE")),d(4),m("completed",r.isStepCompleted(e.estado,"EN_PREPARACION")),d(4),m("completed",r.isStepCompleted(e.estado,"LISTO")),d(4),m("completed",r.isStepCompleted(e.estado,"ENTREGADO"))}}function $(o,c){o&1&&(n(0,"div",32)(1,"p"),i(2,"Este pedido ha sido cancelado."),t()())}function j(o,c){if(o&1&&(n(0,"div",16)(1,"div",17)(2,"span",18),i(3),t(),n(4,"span",19),i(5),t()(),n(6,"div",20)(7,"h4"),i(8,"Detalle del Pedido"),t(),n(9,"ul",21),x(10,U,2,2,"li",22),t(),n(11,"div",23)(12,"p")(13,"strong"),i(14,"Mesa:"),t(),i(15),t(),n(16,"p")(17,"strong"),i(18,"Total:"),t(),i(19),u(20,"currency"),t(),n(21,"p")(22,"strong"),i(23,"Fecha:"),t(),i(24),u(25,"date"),t(),x(26,B,4,1,"p",24),t()(),x(27,G,18,8,"div",25)(28,$,3,0,"div",26),t()),o&2){let e=c.$implicit,r=g(2);l("ngClass",e.estado.toLowerCase()),d(3),f("Pedido #",(e.id==null?null:e.id.substring(0,8))||"Nuevo",""),d(2),h(r.getEstadoLabel(e.estado)),d(5),l("ngForOf",e.items),d(5),f(" ",e.mesa,""),d(4),f(" ",I(20,10,e.total,"COP","symbol","1.0-0"),""),d(5),f(" ",C(25,15,e.fechaCreacion,"dd/MM/yyyy H:mm"),""),d(2),l("ngIf",e.observaciones),d(),l("ngIf",e.estado!=="ENTREGADO"&&e.estado!=="CANCELADO"),d(),l("ngIf",e.estado==="CANCELADO")}}function H(o,c){if(o&1&&(n(0,"div",14),x(1,j,29,18,"div",15),t()),o&2){let e=g();d(),l("ngForOf",e.misPedidos)}}var Z=(()=>{class o{constructor(e){this.pedidoService=e,this.misPedidos=[],this.selectedFilter="all",this.isLoading=!1,this.lastUpdate=null,this.clienteId=localStorage.getItem("clienteId")||"cliente-"+Math.floor(Math.random()*1e3),localStorage.getItem("clienteId")||localStorage.setItem("clienteId",this.clienteId)}ngOnInit(){this.loadUserPedidos(),this.pedidosInterval=setInterval(()=>{this.loadUserPedidos()},3e4)}ngOnDestroy(){this.pedidosInterval&&clearInterval(this.pedidosInterval)}loadUserPedidos(){this.isLoading=!0,this.pedidoService.getPedidosByCliente(this.clienteId).subscribe({next:e=>{this.misPedidos=e,this.filterPedidos(this.selectedFilter),console.log(`Se cargaron ${e.length} pedidos para el cliente ${this.clienteId}`),localStorage.setItem("clienteId",this.clienteId),this.isLoading=!1,this.lastUpdate=new Date},error:e=>{console.error("Error al cargar los pedidos del usuario",e),this.isLoading=!1}})}filterPedidos(e){this.selectedFilter=e;let r=[...this.misPedidos];e==="all"||(e==="activos"?this.misPedidos=r.filter(a=>a.estado!==s.ENTREGADO&&a.estado!==s.CANCELADO):e==="completados"&&(this.misPedidos=r.filter(a=>a.estado===s.ENTREGADO||a.estado===s.CANCELADO))),this.misPedidos.sort((a,p)=>{let v=a.fechaCreacion?new Date(a.fechaCreacion):new Date;return(p.fechaCreacion?new Date(p.fechaCreacion):new Date).getTime()-v.getTime()})}getEstadoLabel(e){return{[s.PENDIENTE]:"Pendiente",[s.EN_PREPARACION]:"En Preparaci\xF3n",[s.LISTO]:"Listo para Entregar",[s.ENTREGADO]:"Entregado",[s.CANCELADO]:"Cancelado"}[e]||"Desconocido"}isStepCompleted(e,r){let a=[s.PENDIENTE,s.EN_PREPARACION,s.LISTO,s.ENTREGADO],p=a.indexOf(e);return a.indexOf(r)<=p}static{this.\u0275fac=function(r){return new(r||o)(O(L))}}static{this.\u0275cmp=b({type:o,selectors:[["app-pedidos"]],standalone:!0,features:[M],decls:20,vars:10,consts:[[1,"container"],[1,"material-icons"],[1,"filtros"],[1,"filter-btn",3,"click"],[1,"refresh-btn",3,"click"],["class","last-update",4,"ngIf"],["class","no-pedidos",4,"ngIf"],["class","loading-indicator",4,"ngIf"],["class","pedidos-grid",4,"ngIf"],[1,"last-update"],[1,"no-pedidos"],["routerLink","/chat-asistente",1,"go-to-chat"],[1,"loading-indicator"],[1,"spinner"],[1,"pedidos-grid"],["class","pedido-card",3,"ngClass",4,"ngFor","ngForOf"],[1,"pedido-card",3,"ngClass"],[1,"pedido-header"],[1,"pedido-id"],[1,"pedido-status"],[1,"pedido-content"],[1,"pedido-items"],[4,"ngFor","ngForOf"],[1,"pedido-info"],[4,"ngIf"],["class","pedido-progress",4,"ngIf"],["class","pedido-status-message",4,"ngIf"],[1,"pedido-progress"],[1,"progress-steps"],[1,"step"],[1,"step-dot"],[1,"step-label"],[1,"pedido-status-message"]],template:function(r,a){r&1&&(n(0,"div",0)(1,"h2")(2,"i",1),i(3,"receipt_long"),t(),i(4," Mis Pedidos"),t(),n(5,"div",2)(6,"button",3),P("click",function(){return a.filterPedidos("all")}),i(7,"Todos"),t(),n(8,"button",3),P("click",function(){return a.filterPedidos("activos")}),i(9,"Activos"),t(),n(10,"button",3),P("click",function(){return a.filterPedidos("completados")}),i(11,"Completados"),t(),n(12,"button",4),P("click",function(){return a.loadUserPedidos()}),n(13,"i",1),i(14,"refresh"),t(),i(15," Actualizar "),t()(),x(16,F,4,4,"div",5)(17,R,5,0,"div",6)(18,z,4,0,"div",7)(19,H,2,1,"div",8),t()),r&2&&(d(6),m("active",a.selectedFilter==="all"),d(2),m("active",a.selectedFilter==="activos"),d(2),m("active",a.selectedFilter==="completados"),d(6),l("ngIf",a.lastUpdate),d(),l("ngIf",a.misPedidos.length===0),d(),l("ngIf",a.isLoading),d(),l("ngIf",a.misPedidos.length>0&&!a.isLoading))},dependencies:[A,S,y,k,N,T,w,D],styles:['.container[_ngcontent-%COMP%]{padding:0;max-width:1000px;margin:0 auto}h2[_ngcontent-%COMP%]{color:#ffcc29;display:flex;align-items:center;gap:10px}h2[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:1.8rem}h4[_ngcontent-%COMP%]{color:#ffcc29}.filtros[_ngcontent-%COMP%]{display:flex;gap:10px;margin:20px 0}.filter-btn[_ngcontent-%COMP%]{padding:8px 16px;background:#333;color:#fff;border:none;border-radius:4px;cursor:pointer;transition:all .3s ease}.filter-btn[_ngcontent-%COMP%]:hover{background:#ffdd54;box-shadow:0 0 8px #ffcc29}.refresh-btn[_ngcontent-%COMP%]{padding:8px 16px;background:#444;color:#fff;border:none;border-radius:4px;cursor:pointer;transition:all .3s ease;display:flex;align-items:center;gap:5px;margin-left:auto}.refresh-btn[_ngcontent-%COMP%]:hover{background:#555;transform:translateY(-2px)}.refresh-btn[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:18px}.last-update[_ngcontent-%COMP%]{text-align:right;color:#777;margin-top:5px;font-size:.8rem}.no-pedidos[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;background:#222;border-radius:8px;margin-top:20px;border:2px solid #ffcc29;color:#ddd}.go-to-chat[_ngcontent-%COMP%]{margin-top:15px;padding:10px 20px;background:#ffcc29;color:#181818;border:none;border-radius:4px;font-weight:700;cursor:pointer;transition:all .3s ease}.go-to-chat[_ngcontent-%COMP%]:hover{background:#ffdd54;box-shadow:0 0 8px #ffcc29}.pedidos-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:20px;margin-top:20px}.pedido-card[_ngcontent-%COMP%]{background:#222;border-radius:8px;overflow:hidden;box-shadow:0 4px 12px #00000026;transition:transform .3s ease;border:2px solid #ffcc29}.pedido-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px)}.pedido-card.pendiente[_ngcontent-%COMP%]{border-left:4px solid #ff9800}.pedido-card.en_preparacion[_ngcontent-%COMP%]{border-left:4px solid #2196f3}.pedido-card.listo[_ngcontent-%COMP%]{border-left:4px solid #4caf50}.pedido-card.entregado[_ngcontent-%COMP%]{border-left:4px solid #9e9e9e;opacity:.8}.pedido-card.cancelado[_ngcontent-%COMP%]{border-left:4px solid #f44336;opacity:.7}.pedido-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px 15px;background:#2a2a2a;border-bottom:1px solid #333}.pedido-id[_ngcontent-%COMP%]{font-weight:700;color:#fff}.pedido-status[_ngcontent-%COMP%]{padding:4px 8px;border-radius:4px;font-size:.85rem;font-weight:500}.pedido-card.pendiente[_ngcontent-%COMP%]   .pedido-status[_ngcontent-%COMP%]{background:#ff9800;color:#000}.pedido-card.en_preparacion[_ngcontent-%COMP%]   .pedido-status[_ngcontent-%COMP%]{background:#2196f3;color:#fff}.pedido-card.listo[_ngcontent-%COMP%]   .pedido-status[_ngcontent-%COMP%]{background:#4caf50;color:#000}.pedido-card.entregado[_ngcontent-%COMP%]   .pedido-status[_ngcontent-%COMP%]{background:#9e9e9e;color:#000}.pedido-card.cancelado[_ngcontent-%COMP%]   .pedido-status[_ngcontent-%COMP%]{background:#f44336;color:#fff}.pedido-content[_ngcontent-%COMP%]{padding:15px}.pedido-items[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0 0 15px;color:#ddd}.pedido-items[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:5px 0;border-bottom:1px dashed #333}.pedido-info[_ngcontent-%COMP%]{color:#bbb;font-size:.95rem}.pedido-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0}.pedido-progress[_ngcontent-%COMP%]{padding:15px;border-top:1px solid #333}.progress-steps[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;position:relative}.progress-steps[_ngcontent-%COMP%]:before{content:"";position:absolute;top:15px;left:20px;right:20px;height:2px;background:#444;z-index:1}.step[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;position:relative;z-index:2}.step-dot[_ngcontent-%COMP%]{width:16px;height:16px;border-radius:50%;background:#444;margin-bottom:8px}.step.completed[_ngcontent-%COMP%]   .step-dot[_ngcontent-%COMP%]{background:#4caf50}.step-label[_ngcontent-%COMP%]{font-size:.8rem;color:#888;text-align:center;max-width:70px}.step.completed[_ngcontent-%COMP%]   .step-label[_ngcontent-%COMP%]{color:#4caf50}.pedido-status-message[_ngcontent-%COMP%]{padding:15px;text-align:center;color:#f44336;border-top:1px solid #333}.loading-indicator[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:30px;background:#222;border-radius:8px;margin-top:20px;color:#ddd}.spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:4px solid rgba(255,204,41,.3);border-radius:50%;border-top-color:#ffcc29;animation:_ngcontent-%COMP%_spin 1s ease-in-out infinite;margin-bottom:15px}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}@media (max-width: 768px){.pedidos-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}']})}}return o})();export{Z as PedidosComponent};
